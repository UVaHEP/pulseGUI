include = Dir('#/include')
picoscopeInclude = Dir('/opt/picoscope/include')
picoscopeDriverInclude = Dir('#/picoscopeDriver')
env = Environment(LIBS=['MathMore', 'Spectrum'], CCFLAGS='-ggdb -std=c++11 ', CPPPATH=[include, picoscopeDriverInclude, picoscopeInclude, '#'])
env.ParseConfig("root-config --cflags --glibs")

print env['CPPPATH']	
#

## Generate Root Dictionary File 
cintBuilder = Builder(action = 'rootcint -f $TARGET -c $SOURCES')
env.Append(BUILDERS= {'cint': cintBuilder})

pGDict = env.cint('PulseGUIDict.cxx', ['#/include/PulseGUI.h'])
PSControlsDict = env.cint('PicoscopeControlsDict.cxx', ['#/include/PicoscopeControls.h'])
Clean(PSControlsDict, 'PicoscopeControlsDict.h')

pADict = env.cint('PulseAnalysisDict.cxx', ['#/include/PulseAnalysis.h', '#/include/PulseAnalysisLinkDef.h'])
PSbuffer = env.cint('PSbuffer.cxx', ['#/include/PSbuffer.h'])
Clean(pGDict, 'PulseGUIDict.h')
Clean(pADict, 'PulseAnalysisDict.h')
Clean(PSbuffer, 'PSbufferDict.h')

psControlsDictObj = env.SharedLibrary(PSControlsDict)
paDictObj = env.SharedLibrary(pADict)
pgDictObj = env.SharedLibrary(pGDict)
PSbufferDictObj = env.SharedLibrary(PSbuffer)


psControls = env.SharedLibrary('PicoscopeControls', ['PicoscopeControls.cc', psControlsDictObj, '#/picoscopeDriver/libpicoscopeDriver.so'])
pR = env.SharedLibrary('picoReader', ['PicoReader.cc'])
pA = env.SharedLibrary('PulseAnalysis', ['PulseAnalysis.cc', 'PulseAnalysis.analysis.cc', 'PulseAnalysis.display.cc', paDictObj, pR, PSbufferDictObj])
env.Install('#/exe', [pA, paDictObj])
pG = env.SharedLibrary('PulseGUI', ['PulseGUI.cc', 'PulseGUI.actions.cc', 'PulseGUI.gui.cc', pgDictObj, pA, pR, PSbufferDictObj])
env.Install('#/exe', [pG, pgDictObj])
env.Install('#/exe', [PSbufferDictObj])
